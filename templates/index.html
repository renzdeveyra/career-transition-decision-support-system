<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Career Transition Decision Support System</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css"
    />
    <style>
      body {
        padding-top: 2rem;
        padding-bottom: 2rem;
      }
      .form-section {
        margin-bottom: 2rem;
      }
      .recommendation-content {
        font-size: 1rem;
        line-height: 1.6;
      }
      .recommendation-content h1 {
        font-size: 1.8rem;
        margin-bottom: 1rem;
        color: #0d6efd;
      }
      .recommendation-content h2 {
        font-size: 1.5rem;
        margin-top: 1.5rem;
        margin-bottom: 0.75rem;
        color: #495057;
        border-bottom: 1px solid #dee2e6;
        padding-bottom: 0.5rem;
      }
      .recommendation-content h3 {
        font-size: 1.2rem;
        margin-top: 1.2rem;
        margin-bottom: 0.5rem;
        color: #6c757d;
      }
      .recommendation-content ul,
      .recommendation-content ol {
        padding-left: 1.5rem;
        margin-bottom: 1rem;
      }
      .recommendation-content li {
        margin-bottom: 0.5rem;
      }
      .recommendation-content strong {
        color: #0d6efd;
        font-weight: 600;
      }
      .recommendation-section {
        margin-bottom: 1.5rem;
        padding: 1rem;
        border-radius: 0.375rem;
        background-color: #f8f9fa;
        border-left: 4px solid #0d6efd;
      }
      .pros-cons-container {
        display: flex;
        flex-wrap: wrap;
        gap: 1rem;
        margin: 1rem 0;
      }
      .pros-container,
      .cons-container {
        flex: 1;
        min-width: 250px;
        padding: 1rem;
        border-radius: 0.375rem;
      }
      .pros-container {
        background-color: rgba(25, 135, 84, 0.1);
        border-left: 4px solid #198754;
      }
      .cons-container {
        background-color: rgba(220, 53, 69, 0.1);
        border-left: 4px solid #dc3545;
      }
      .confidence-indicator {
        display: inline-block;
        padding: 0.25rem 0.5rem;
        border-radius: 0.25rem;
        font-weight: 600;
        margin-left: 0.5rem;
      }
      .confidence-high {
        background-color: rgba(25, 135, 84, 0.2);
        color: #198754;
      }
      .confidence-medium {
        background-color: rgba(255, 193, 7, 0.2);
        color: #fd7e14;
      }
      .confidence-low {
        background-color: rgba(220, 53, 69, 0.2);
        color: #dc3545;
      }
      .next-steps-item {
        display: flex;
        align-items: flex-start;
        margin-bottom: 0.75rem;
      }
      .next-steps-item i {
        margin-right: 0.5rem;
        color: #0d6efd;
        flex-shrink: 0;
      }
      .expert-card {
        margin-bottom: 1rem;
        border-left: 4px solid #6c757d;
        padding-left: 1rem;
      }
      .simulation-result-item {
        display: flex;
        align-items: center;
        margin-bottom: 0.5rem;
      }
      .simulation-result-item i {
        margin-right: 0.5rem;
        color: #0d6efd;
      }
      .summary-box {
        background-color: rgba(13, 110, 253, 0.1);
        border-radius: 0.375rem;
        padding: 1rem;
        margin-bottom: 1.5rem;
        border-left: 4px solid #0d6efd;
      }
      .alternative-option {
        font-style: italic;
        color: #6c757d;
        margin-top: 0.5rem;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <h1 class="mb-4">Career Transition Decision Support System</h1>
      <p class="lead">
        Enter your information below to receive personalized career transition
        advice.
      </p>

      <form id="career-form" class="needs-validation" novalidate>
        <div class="form-section">
          <h3>Personal Information</h3>
          <div class="row g-3">
            <div class="col-md-6">
              <label for="age" class="form-label">Age</label>
              <input
                type="number"
                class="form-control"
                id="age"
                name="age"
                required
                min="18"
                max="65"
              />
            </div>
            <div class="col-md-6">
              <label for="has_degree" class="form-label"
                >Do you have a college degree?</label
              >
              <select
                class="form-select"
                id="has_degree"
                name="has_degree"
                required
              >
                <option value="true">Yes</option>
                <option value="false">No</option>
              </select>
            </div>
            <div class="col-md-6">
              <label for="highest_education" class="form-label"
                >Highest Education Level</label
              >
              <select
                class="form-select"
                id="highest_education"
                name="highest_education"
                required
              >
                <option value="High School">High School</option>
                <option value="Some College">Some College</option>
                <option value="Associate's Degree">Associate's Degree</option>
                <option value="Bachelor's Degree" selected>
                  Bachelor's Degree
                </option>
                <option value="Master's Degree">Master's Degree</option>
                <option value="Doctorate">Doctorate</option>
              </select>
            </div>
          </div>
        </div>

        <div class="form-section">
          <h3>Career Information</h3>
          <div class="row g-3">
            <div class="col-md-6">
              <label for="bpo_experience_years" class="form-label"
                >Years of BPO Experience</label
              >
              <input
                type="number"
                class="form-control"
                id="bpo_experience_years"
                name="bpo_experience_years"
                required
                step="0.5"
                min="0"
                max="30"
              />
            </div>
            <div class="col-md-6">
              <label for="current_role" class="form-label">Current Role</label>
              <select
                class="form-select"
                id="current_role"
                name="current_role"
                required
              >
                <option value="Customer Service Representative" selected>
                  Customer Service Representative
                </option>
                <option value="Technical Support Agent">
                  Technical Support Agent
                </option>
                <option value="Sales Agent">Sales Agent</option>
                <option value="Team Leader">Team Leader</option>
                <option value="Quality Analyst">Quality Analyst</option>
                <option value="Trainer">Trainer</option>
                <option value="Operations Manager">Operations Manager</option>
                <option value="Other">Other</option>
              </select>
            </div>
            <div class="col-md-6">
              <label for="current_salary" class="form-label"
                >Current Monthly Salary (PHP)</label
              >
              <input
                type="number"
                class="form-control"
                id="current_salary"
                name="current_salary"
                required
                min="10000"
                max="200000"
              />
            </div>
            <div class="col-md-6">
              <label for="bpo_satisfaction" class="form-label"
                >Satisfaction with BPO Career (1-10)</label
              >
              <input
                type="range"
                class="form-range"
                id="bpo_satisfaction"
                name="bpo_satisfaction"
                min="1"
                max="10"
                value="5"
              />
              <div class="d-flex justify-content-between">
                <span>Very Dissatisfied</span>
                <span>Very Satisfied</span>
              </div>
            </div>
            <div class="col-md-6">
              <label for="performance_level" class="form-label"
                >Performance Level</label
              >
              <select
                class="form-select"
                id="performance_level"
                name="performance_level"
                required
              >
                <option value="poor">Poor</option>
                <option value="average">Average</option>
                <option value="good" selected>Good</option>
                <option value="excellent">Excellent</option>
              </select>
            </div>
          </div>
        </div>

        <div class="form-section">
          <h3>Personality Traits</h3>
          <div class="row g-3">
            <div class="col-md-4">
              <label for="conscientiousness" class="form-label"
                >Conscientiousness (Detail-oriented, Organized)</label
              >
              <select
                class="form-select"
                id="conscientiousness"
                name="conscientiousness"
                required
              >
                <option value="low">Low</option>
                <option value="medium" selected>Medium</option>
                <option value="high">High</option>
              </select>
            </div>
            <div class="col-md-4">
              <label for="extroversion" class="form-label"
                >Extroversion (Social, Outgoing)</label
              >
              <select
                class="form-select"
                id="extroversion"
                name="extroversion"
                required
              >
                <option value="low">Low</option>
                <option value="medium" selected>Medium</option>
                <option value="high">High</option>
              </select>
            </div>
            <div class="col-md-4">
              <label for="openness" class="form-label"
                >Openness (Creative, Open to new experiences)</label
              >
              <select
                class="form-select"
                id="openness"
                name="openness"
                required
              >
                <option value="low">Low</option>
                <option value="medium">Medium</option>
                <option value="high" selected>High</option>
              </select>
            </div>
          </div>
        </div>

        <div class="form-section">
          <h3>Preferences</h3>
          <div class="row g-3">
            <div class="col-md-6">
              <label class="form-label"
                >Interests (select all that apply)</label
              >
              <div class="form-check">
                <input
                  class="form-check-input"
                  type="checkbox"
                  name="interests"
                  value="technology"
                  id="interest_technology"
                  checked
                />
                <label class="form-check-label" for="interest_technology"
                  >Technology</label
                >
              </div>
              <div class="form-check">
                <input
                  class="form-check-input"
                  type="checkbox"
                  name="interests"
                  value="leadership"
                  id="interest_leadership"
                  checked
                />
                <label class="form-check-label" for="interest_leadership"
                  >Leadership</label
                >
              </div>
              <div class="form-check">
                <input
                  class="form-check-input"
                  type="checkbox"
                  name="interests"
                  value="business"
                  id="interest_business"
                />
                <label class="form-check-label" for="interest_business"
                  >Business</label
                >
              </div>
              <div class="form-check">
                <input
                  class="form-check-input"
                  type="checkbox"
                  name="interests"
                  value="creative"
                  id="interest_creative"
                />
                <label class="form-check-label" for="interest_creative"
                  >Creative</label
                >
              </div>
              <div class="form-check">
                <input
                  class="form-check-input"
                  type="checkbox"
                  name="interests"
                  value="learning"
                  id="interest_learning"
                />
                <label class="form-check-label" for="interest_learning"
                  >Learning/Academic</label
                >
              </div>
              <div class="form-check">
                <input
                  class="form-check-input"
                  type="checkbox"
                  name="interests"
                  value="management"
                  id="interest_management"
                />
                <label class="form-check-label" for="interest_management"
                  >Management</label
                >
              </div>
              <div class="form-check">
                <input
                  class="form-check-input"
                  type="checkbox"
                  name="interests"
                  value="specialized_bpo"
                  id="interest_specialized_bpo"
                />
                <label class="form-check-label" for="interest_specialized_bpo"
                  >Specialized BPO Roles</label
                >
              </div>
            </div>
            <div class="col-md-6">
              <label for="financial_pressure" class="form-label"
                >Financial Pressure</label
              >
              <select
                class="form-select"
                id="financial_pressure"
                name="financial_pressure"
                required
              >
                <option value="low">Low</option>
                <option value="medium" selected>Medium</option>
                <option value="high">High</option>
              </select>

              <div class="mt-3">
                <label for="work_life_balance_importance" class="form-label"
                  >Work-Life Balance Importance</label
                >
                <select
                  class="form-select"
                  id="work_life_balance_importance"
                  name="work_life_balance_importance"
                  required
                >
                  <option value="low">Low</option>
                  <option value="medium">Medium</option>
                  <option value="high" selected>High</option>
                </select>
              </div>

              <div class="mt-3">
                <label for="identified_alternative_field" class="form-label"
                  >Have you identified an alternative field?</label
                >
                <select
                  class="form-select"
                  id="identified_alternative_field"
                  name="identified_alternative_field"
                  required
                >
                  <option value="true" selected>Yes</option>
                  <option value="false">No</option>
                </select>
              </div>

              <div class="mt-3">
                <label for="alternative_field" class="form-label"
                  >Alternative Field of Interest</label
                >
                <select
                  class="form-select"
                  id="alternative_field"
                  name="alternative_field"
                  required
                >
                  <option value="tech" selected>Technology/IT</option>
                  <option value="business">Business/Management</option>
                  <option value="education">Education/Training</option>
                  <option value="healthcare">Healthcare</option>
                  <option value="creative">Creative/Design</option>
                  <option value="other">Other</option>
                </select>
              </div>

              <div class="mt-3">
                <label for="researched_requirements" class="form-label"
                  >Have you researched requirements for this field?</label
                >
                <select
                  class="form-select"
                  id="researched_requirements"
                  name="researched_requirements"
                  required
                >
                  <option value="true" selected>Yes</option>
                  <option value="false">No</option>
                </select>
              </div>
            </div>
          </div>
        </div>

        <div class="d-grid gap-2 mt-4">
          <button class="btn btn-primary" type="submit">
            Get Career Recommendation
          </button>
        </div>
      </form>

      <div id="results" class="mt-5 d-none">
        <h2>Your Career Recommendation</h2>
        <div class="card mb-4">
          <div class="card-body">
            <h3 id="recommendation-title" class="card-title"></h3>
            <div
              id="recommendation-explanation"
              class="recommendation-content"
            ></div>
          </div>
        </div>

        <div id="visualization-container" class="mb-4">
          <h3>Career Path Comparison</h3>
          <img
            id="visualization"
            class="img-fluid"
            alt="Career path visualization"
          />
        </div>
      </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <script>
      document
        .getElementById("career-form")
        .addEventListener("submit", function (e) {
          e.preventDefault();

          const formData = new FormData(this);

          fetch("/analyze", {
            method: "POST",
            body: formData,
          })
            .then((response) => response.json())
            .then((data) => {
              // Display results
              document.getElementById("results").classList.remove("d-none");

              // Update recommendation title
              document.getElementById("recommendation-title").textContent =
                data.recommendation
                  ? data.recommendation.name
                  : "No specific recommendation";

              // Format and display explanation using marked.js to convert markdown to HTML
              const explanationHtml = marked.parse(data.explanation);

              // Apply custom formatting to the HTML
              let formattedHtml = explanationHtml;

              // Format summary section
              formattedHtml = formattedHtml.replace(
                /<h2>Summary<\/h2>([\s\S]*?)(?=<h2>)/g,
                '<h2>Summary</h2><div class="summary-box">$1</div>'
              );

              // Format expert inputs
              formattedHtml = formattedHtml.replace(
                /<h3>(Career Counselor|Senior Bpo Employee|Academic Advisor)<\/h3>([\s\S]*?)(?=<h3>|<h2>)/g,
                '<div class="expert-card"><h3>$1</h3>$2</div>'
              );

              // Format pros and cons section
              formattedHtml = formattedHtml.replace(
                /<h3>Pros<\/h3>\s*<ul>([\s\S]*?)<\/ul>\s*<h3>Cons<\/h3>\s*<ul>([\s\S]*?)<\/ul>/g,
                '<div class="pros-cons-container"><div class="pros-container"><h3>Pros</h3><ul>$1</ul></div><div class="cons-container"><h3>Cons</h3><ul>$2</ul></div></div>'
              );

              // Add icons to simulation results
              formattedHtml = formattedHtml.replace(
                /<li>Projected salary growth:(.*?)<\/li>/g,
                '<li class="simulation-result-item"><i class="bi bi-graph-up-arrow"></i>Projected salary growth:$1</li>'
              );
              formattedHtml = formattedHtml.replace(
                /<li>Average job satisfaction:(.*?)<\/li>/g,
                '<li class="simulation-result-item"><i class="bi bi-emoji-smile"></i>Average job satisfaction:$1</li>'
              );
              formattedHtml = formattedHtml.replace(
                /<li>Average job stability:(.*?)<\/li>/g,
                '<li class="simulation-result-item"><i class="bi bi-shield-check"></i>Average job stability:$1</li>'
              );

              // Add icons to next steps
              formattedHtml = formattedHtml.replace(
                /<h2>Next Steps<\/h2>[\s\S]*?<ul>([\s\S]*?)<\/ul>/g,
                '<h2>Next Steps</h2><ul class="next-steps-list">$1</ul>'
              );
              formattedHtml = formattedHtml.replace(
                /<li>([^<]*)<\/li>/g,
                function (match, p1) {
                  // Only replace in the next steps section
                  if (match.includes('class="simulation-result-item"')) {
                    return match;
                  }
                  return (
                    '<li class="next-steps-item"><i class="bi bi-check-circle-fill"></i><span>' +
                    p1 +
                    "</span></li>"
                  );
                }
              );

              // Add confidence indicator styling
              formattedHtml = formattedHtml
                .replace(
                  /Confidence level: <strong>(High|Medium|Low)<\/strong>/g,
                  'Confidence level: <span class="confidence-indicator confidence-$1">$1</span>'
                )
                .replace(/confidence-High/g, "confidence-high")
                .replace(/confidence-Medium/g, "confidence-medium")
                .replace(/confidence-Low/g, "confidence-low");

              // Format alternative option
              formattedHtml = formattedHtml.replace(
                /Alternative option: ([^<]*)/g,
                '<div class="alternative-option">Alternative option: <strong>$1</strong></div>'
              );

              document.getElementById("recommendation-explanation").innerHTML =
                formattedHtml;

              // Update visualization if available
              if (data.visualization) {
                document.getElementById("visualization").src =
                  "data:image/png;base64," + data.visualization;
                document
                  .getElementById("visualization-container")
                  .classList.remove("d-none");
              } else {
                document
                  .getElementById("visualization-container")
                  .classList.add("d-none");
              }

              // Scroll to results
              document
                .getElementById("results")
                .scrollIntoView({ behavior: "smooth" });
            })
            .catch((error) => {
              console.error("Error:", error);
              alert(
                "An error occurred while processing your request. Please try again."
              );
            });
        });
    </script>
  </body>
</html>
